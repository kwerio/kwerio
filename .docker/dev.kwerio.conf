<VirtualHost *:80>
    ServerName kwerio-ce.test
    ServerAlias *.kwerio-ce.test
    ServerAdmin euvoor@gmail.com

    DocumentRoot /var/www/html/public

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    # --------------------------------------------------------------- HMR -- #
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://127.0.0.1:8080/$1 [P,L]

    ProxyPassMatch "^/(.*\.js(/.*)?)$" "http://127.0.0.1:8080/"
    AddOutputFilterByType INFLATE;SUBSTITUTE;DEFLATE application/javascript
    SubstituteMaxLineLength 10m
    Substitute "s|http://127.0.0.1:8080/|https://kwerio-ce.test/|i"

    ProxyPassMatch "^/(.*\.hot-update.json)$" "http://127.0.0.1:8080/"

    ProxyPass /fonts/ http://127.0.0.1:8080/fonts/
    ProxyPassReverse /fonts/ http://127.0.0.1:8080/fonts/

    ProxyPass /sockjs-node/ http://127.0.0.1:8080/sockjs-node/
    ProxyPassReverse /sockjs-node/ http://127.0.0.1:8080/sockjs-node/
	# ========================================================= HMR - END == #
</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
